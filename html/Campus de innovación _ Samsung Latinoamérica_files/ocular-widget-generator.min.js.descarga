"use strict";const WIDGET_GENERATOR_DEBUG=!1;class OcularWidget{constructor(){window.addEventListener("message",this.receiver,!1),this.STORAGE_NAME="ocular-solution-widget",this.siteBody=document.querySelector("body"),this.container,this.iFrame,this.toolbar,this.togglerButtonElement,this.popUp,this.setDefaultConfig(),this.getDevice()}async ajaxRequest(data){return"object"==typeof data&&new Promise((resolve,reject)=>{try{"GET"===data.method&&(data.route+="?"+Object.keys(data.params).map(key=>`${key}=${encodeURIComponent(data.params[key])}`).join("&"));const xhr=new XMLHttpRequest;xhr.open(data.method,`${OCULAR_API_URL}/${data.route}`,!0),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.onload=()=>{if(200===xhr.status){const res=JSON.parse(xhr.responseText);resolve(res)}else{const error={status:xhr.status,statusText:xhr.statusText};reject(error)}};const params=Object.keys(data.params),formData=new FormData;params.map(paramName=>{formData.append(paramName,data.params[paramName])}),xhr.send(formData)}catch(error){this.handleError(error,"ajaxRequest")}})}setDefaultConfig(config){this.widgetIcon=config&&config.toggler&&config.toggler.image&&config.toggler.image.src?config.toggler.image.src:scriptOcular.dataset.image?scriptOcular.dataset.image:`${OCULAR_BASE_URL}/service/ocular/images/widgeticon.svg`;const primaryColor=config&&config.primaryColor?config.primaryColor:"#204DEF";this.defaultAttrs={width:360,height:config&&config.height?config.height:630,"border-radius":config&&config.borderRadius?config.borderRadius:"8px",margin:20,"margin-x":config&&config.marginX?config.marginX:20,"margin-y":config&&config.marginY?config.marginY:20,"primary-color":primaryColor,"toolbar-height":0,align:"right","dark-mode":!0,border:"0px solid #E6E6E6","z-index":config&&config.zIndex?config.zIndex:"999999",toggler:{width:config&&config.toggler&&config.toggler.width?config.toggler.width:70,height:config&&config.toggler&&config.toggler.height?config.toggler.height:70,"border-radius":config&&config.toggler&&config.toggler.borderRadius?config.toggler.borderRadius:"50%",color:config&&config.toggler&&config.toggler.color?config.toggler.color:primaryColor,"box-shadow":!config||!config.toggler||void 0===config.toggler.boxShadow||config.toggler.boxShadow,image:{width:config&&config.toggler&&config.toggler.image&&config.toggler.image.width?config.toggler.image.width:45,height:config&&config.toggler&&config.toggler.image&&config.toggler.image.height?config.toggler.image.height:45}}},config&&this.updateStyles()}reTry(){location.reload(!0)}updateStyles(){this.setOcularTogglerStyle(),this.setContainerStyle(),this.setFrameStyle(),this.setPopUpStyle(),this.setPopUpProgressStyle(),this.checkSiteDimensions(),this.setTogglerConfig()}setTogglerConfig(){if(!this.buttonIconElement)return!1;this.buttonIconElement.width=this.defaultAttrs.toggler.image.width,this.buttonIconElement.height=this.defaultAttrs.toggler.image.height,this.buttonIconElement.src=this.widgetIcon}receiver(event){event.origin===OCULAR_APP_URL&&eval(event.data)}crossDomainMessage(msg){try{const iFrameWindow=document.querySelector("iframe#ocular-widget-iframe");iFrameWindow.contentWindow&&iFrameWindow.contentWindow.postMessage(msg,OCULAR_APP_URL)}catch(error){console.log("crossDomainMessage disable")}}cleanHistory(originalUrl){history.pushState({},null,originalUrl)}setWidgetParams(){const receivedParameters=new URLSearchParams(location.search);receivedParameters.get("ocularSessionId")?this.params.set("ocularSessionId",receivedParameters.get("ocularSessionId")):receivedParameters.get("ocularLinkSessionId")?(this.params.set("ocularLinkSessionId",receivedParameters.get("ocularLinkSessionId")),this.params.set("ocularCustomer",receivedParameters.get("ocularCustomer"))):receivedParameters.get("ocularStreaming")&&(this.params.set("ocularStreaming",receivedParameters.get("ocularStreaming")),this.cleanHistory(`${location.origin}${location.pathname}`)),receivedParameters.get("ocularOriginalUrl")&&this.cleanHistory(receivedParameters.get("ocularOriginalUrl")),receivedParameters.has("ocularWidgetCode")&&this.params.set("ocularWidgetCode",receivedParameters.get("ocularWidgetCode"))}urlSearchParams(){this.params=new URLSearchParams(""),this.params.set("title",document.querySelector("head title")?document.querySelector("head title").innerHTML:""),this.params.set("hostname",location.hostname),this.params.set("origin",location.origin),this.params.set("pathname",location.pathname);const script=document.querySelector('script[name="ocular-solution-widget"]'),scriptCode=script?script.getAttribute("code"):null;return scriptCode&&this.params.set("organizationCode",scriptCode),this.setWidgetParams(),this.params.toString()}setStorage(){this.storageData=localStorage.getItem(this.STORAGE_NAME)?JSON.parse(localStorage.getItem(this.STORAGE_NAME)):null}updateStorageData(){navigator.cookieEnabled&&(localStorage.setItem(this.STORAGE_NAME,JSON.stringify(this.widgetData)),this.storageData=this.widgetData)}initializeStorageData(hard){navigator.cookieEnabled&&this.setStorage(),this.widgetData={state:!hard&&this.storageData&&this.storageData.state?this.storageData.state:"minimized"},this.updateStorageData()}handleError(error,handler){const errorDetail={handler:handler,name:error.name,message:error.message,errorResponse:error};WIDGET_GENERATOR_DEBUG&&console.error("There was an error",errorDetail)}init(){return new Promise((resolve,reject)=>{this.createOcularToggler(),this.createPopUp(),this.createOcularContainer(),this.setDarkMode(this.defaultAttrs["dark-mode"]),this.align(this.defaultAttrs.align),this.initializeStorageData(!1),resolve("success")})}restore(){"open"===this.widgetData.state&&this.show(!0)}setCustomer(customer){let localStorageData=localStorage.getItem(ocularStorage.STORAGE_NAME);localStorageData=localStorageData?JSON.parse(localStorageData):null,localStorageData||console.log("Customer not set"),localStorageData.room.customer=customer,ocularStorage.updateStorageData(localStorageData);try{this.crossDomainMessage(`ocularStorage.setCustomer(${JSON.stringify(customer)})`)}catch(error){console.log("crossDomainMessage disable")}}setLocale(lang){const langs=["en","es","pt"];if(!langs.find(item=>item===lang))return!1;let localStorageData=localStorage.getItem(ocularStorage.STORAGE_NAME);localStorageData=localStorageData?JSON.parse(localStorageData):null,localStorageData||console.log("Locale not set"),localStorageData.widget.lang=lang,ocularStorage.updateStorageData(localStorageData);try{this.crossDomainMessage(`ocularStorage.setLocale(${JSON.stringify(lang)})`)}catch(error){console.log("crossDomainMessage disable")}}setBuyOrderSessionId(sesionId){try{ocularOrderTrack.setSessionId(sesionId)}catch(error){}}toggle(show=null){if(!this.container)return!1;null===show?this.togglerButtonElement.classList.toggle("active"):show?this.togglerButtonElement.classList.add("active"):this.togglerButtonElement.classList.remove("active"),this.toggleContainer(),this.widgetData.state=this.container.dataset.state,this.updateStorageData(),"open"===this.widgetData.state&&(this.iFrame||this.createOcularFrame())}parentToggle(){"open"===this.container.dataset.state?this.hide():this.show(!0)}async show(all,init=!1,createApp=!1){if(!this.container)return!1;init&&"open"===this.container.dataset.state&&(all=!0),this.showToggler(!0),all&&(this.togglerButtonElement.classList.add("active"),this.toggleContainer()),this.container.dataset.state=all?"open":"minimized",this.widgetData.state=this.container.dataset.state,this.updateStorageData(),"open"!==this.widgetData.state&&!createApp||this.iFrame||this.createOcularFrame();const widgetBasic=organization.widgetBasic,attributes=widgetBasic.attributes;setTimeout(()=>{attributes.length&&!widget.popupDisplayed()&&widget.showPopUpMessage(attributes)},6e3)}hide(){if(!this.container)return!1;this.showToggler(!1),this.togglerButtonElement.classList.remove("active"),this.toggleContainer(!0),this.container.dataset.state="hidden",this.showPopUp(!1),this.widgetData.state=this.container.dataset.state,this.updateStorageData()}align(position){if(!this.container)return!1;switch(position){case"left":this.container.style.right="auto",this.container.style.left="0px",this.container.style["-webkit-transform"]="translateX(0%)",this.container.style.transform="translateX(0%)",this.popUp&&(this.popUp.style.right="auto",this.popUp.style.left="0px",this.popUp.style["-webkit-transform"]="translateX(0%)",this.popUp.style.transform="translateX(0%)"),this.togglerButtonElement.style.right="auto",this.togglerButtonElement.style.left="0px",this.togglerButtonElement.style["-webkit-transform"]="translateX(0%)",this.togglerButtonElement.style.transform="translateX(0%)";break;case"center":this.container.style.right="auto",this.container.style.left="50%",this.container.style["-webkit-transform"]="translateX(-50%)",this.container.style.transform="translateX(-50%)",this.popUp&&(this.popUp.style.right="auto",this.popUp.style.left="50%",this.popUp.style["-webkit-transform"]="translateX(-50%)",this.popUp.style.transform="translateX(-50%)"),this.togglerButtonElement.style.right="auto",this.togglerButtonElement.style.left="50%",this.togglerButtonElement.style["-webkit-transform"]="translateX(-50%)",this.togglerButtonElement.style.transform="translateX(-50%)";break;case"right":this.container.style.right="0px",this.container.style.left="auto",this.container.style["-webkit-transform"]="translateX(0%)",this.container.style.transform="translateX(0%)",this.popUp&&(this.popUp.style.right="0px",this.popUp.style.left="auto",this.popUp.style["-webkit-transform"]="translateX(0%)",this.popUp.style.transform="translateX(0%)"),this.togglerButtonElement.style.right="0px",this.togglerButtonElement.style.left="auto",this.togglerButtonElement.style["-webkit-transform"]="translateX(0%)",this.togglerButtonElement.style.transform="translateX(0%)"}}minimize(){if(!this.container)return!1;this.iFrame.style["border-radius"]=`${this.defaultAttrs["border-radius"]}px`,this.containerStyle={width:"100%","max-width":`${this.defaultAttrs.width}px`,height:`calc(100% - ${2*this.defaultAttrs["margin-y"]}px)`,"max-height":`${this.defaultAttrs.height}px`,position:"fixed",transition:"all .2s",margin:`${this.defaultAttrs["margin-y"]}px ${this.defaultAttrs["margin-x"]}px`,bottom:"0px","border-radius":`${this.defaultAttrs["border-radius"]}px`,"z-index":this.defaultAttrs["z-index"],visibility:"visible",opacity:"1","-webkit-box-shadow":"0 3px 5px -1px rgba(0,0,0,.2), 0 5px 8px 0 rgba(0,0,0,.14), 0 1px 14px 0 rgba(0,0,0,.12)","box-shadow":"0 3px 5px -1px rgba(0,0,0,.2), 0 5px 8px 0 rgba(0,0,0,.14), 0 1px 14px 0 rgba(0,0,0,.12)",border:this.defaultAttrs.border,backgroud:"white"};const attrs=Object.keys(this.containerStyle);attrs.map(attrName=>{this.container.style[attrName]=this.containerStyle[attrName]}),this.checkSiteDimensions()}maximize(){if(!this.container)return!1;this.iFrame.style["border-radius"]="0px",this.containerStyle={width:"100%","max-width":"500px",height:"100%","max-height":"100%",position:"fixed",transition:"all .2s",margin:"0px",bottom:"0px","border-radius":"0px","z-index":this.defaultAttrs["z-index"],visibility:"visible",opacity:"1","-webkit-box-shadow":"0 3px 5px -1px rgba(0,0,0,.2), 0 5px 8px 0 rgba(0,0,0,.14), 0 1px 14px 0 rgba(0,0,0,.12)","box-shadow":"0 3px 5px -1px rgba(0,0,0,.2), 0 5px 8px 0 rgba(0,0,0,.14), 0 1px 14px 0 rgba(0,0,0,.12)",border:this.defaultAttrs.border,backgroud:"white"};const attrs=Object.keys(this.containerStyle);attrs.map(attrName=>{this.container.style[attrName]=this.containerStyle[attrName]})}getDevice(){const userAgent=navigator.userAgent,lowerUserAgent=userAgent.toLowerCase(),mobile=lowerUserAgent.indexOf("mobile")>-1;let browserName,so;return-1!=lowerUserAgent.indexOf("edg/")?browserName="Microsoft Edge":-1!=lowerUserAgent.indexOf("opr/")||-1!=lowerUserAgent.indexOf("opera/")?browserName="Opera":-1!=lowerUserAgent.indexOf("chrome/")||-1!=lowerUserAgent.indexOf("crios/")?browserName="Google Chrome":-1!=lowerUserAgent.indexOf("safari/")?browserName="Apple Safari":-1!=lowerUserAgent.indexOf("firefox")&&(browserName="Mozilla Firefox"),-1!=lowerUserAgent.indexOf("win")||-1!=lowerUserAgent.indexOf("windows")?so="Windows":-1!=lowerUserAgent.indexOf("android")?so="Android":-1!=lowerUserAgent.indexOf("linux")?so="Linux":-1!=lowerUserAgent.indexOf("iphone")?so="iPhone":-1==lowerUserAgent.indexOf("mac os")&&-1==lowerUserAgent.indexOf("macintosh")||(so="MacOS"),this.device={userAgent:userAgent,mobile:mobile,browserName:browserName,so:so},this.device}setDarkMode(dark){if(!this.togglerButtonElement)return!1;this.togglerButtonElement.querySelector("img").style.filter=dark?"invert(0%)":"invert(100%)"}checkSiteDimensions(){const totalWidth=this.defaultAttrs.width+2*this.defaultAttrs["margin-x"];totalWidth>document.body.offsetWidth&&(this.container&&(this.container.style.margin="3%",this.container.style.width="94%"),this.popUp&&(this.popUp.style["margin-right"]="3%",this.popUp.style["margin-left"]="3%",this.popUp.style.width="94%"),this.iFrameLoader&&(this.iFrameLoader.style.margin="3%",this.iFrameLoader.style.width="94%"))}createOcularToggler(){if(this.embedContainer=document.getElementById("ocular-service-container"),this.embedContainer)return!1;this.togglerButtonElement=document.createElement("button"),this.setOcularTogglerAttributes(),this.setOcularTogglerStyle(),this.togglerButtonElement.addEventListener("click",this.toggle.bind(this)),this.buttonIconElement=document.createElement("img"),this.buttonIconElement.width=this.defaultAttrs.toggler["img-size"],this.buttonIconElement.height=this.defaultAttrs.toggler["img-size"],this.buttonIconElement.src=this.widgetIcon,this.buttonIconElement.alt="Ocular widget toggler image",this.togglerButtonElement.appendChild(this.buttonIconElement),this.siteBody.appendChild(this.togglerButtonElement)}setOcularTogglerAttributes(){this.togglerAttrs={id:"ocular-widget-toggler"};const attrs=Object.keys(this.togglerAttrs);attrs.map(attrName=>{this.togglerButtonElement.setAttribute(attrName,this.togglerAttrs[attrName])})}setOcularTogglerStyle(){if(!this.togglerButtonElement)return!1;this.togglerStyle={width:`${this.defaultAttrs.toggler.width}px`,height:`${this.defaultAttrs.toggler.height}px`,position:"fixed",transition:"all .2s",margin:`${this.defaultAttrs["margin-y"]}px ${this.defaultAttrs["margin-x"]}px`,bottom:"-10px","border-radius":this.defaultAttrs.toggler["border-radius"],"z-index":"-1",visibility:"hidden",opacity:"0",border:"none",outline:"none",cursor:"pointer","-webkit-box-shadow":this.defaultAttrs.toggler["box-shadow"]?"0px 0px 15px 6px #D3D3D3":"none","box-shadow":this.defaultAttrs.toggler["box-shadow"]?"0px 0px 15px 6px #D3D3D3":"none",background:this.defaultAttrs.toggler.color?this.defaultAttrs.toggler.color:this.defaultAttrs["primary-color"],padding:"0px","text-align":"center"};const attrs=Object.keys(this.togglerStyle);attrs.map(attrName=>{this.togglerButtonElement.style[attrName]=this.togglerStyle[attrName]})}showToggler(show){this.togglerButtonElement.style["z-index"]=show?this.defaultAttrs["z-index"]:"-1",this.togglerButtonElement.style.visibility=show?"visible":"hidden",this.togglerButtonElement.style.opacity=show?"1":"0",this.togglerButtonElement.style.bottom=show?"0px":"-10px"}createOcularContainer(){if(this.embedContainer=document.getElementById("ocular-service-container"),this.embedContainer)return!1;this.container=document.createElement("div"),this.container.setAttribute("data-state","minimized"),this.setContainerAttributes(),this.setContainerStyle(),this.checkSiteDimensions(),this.siteBody.appendChild(this.container)}setContainerAttributes(){this.containerAttrs={id:"ocular-widget-container"};const attrs=Object.keys(this.containerAttrs);attrs.map(attrName=>{this.container.setAttribute(attrName,this.containerAttrs[attrName])})}setContainerStyle(){if(!this.container)return!1;this.containerStyle={width:"100%","max-width":`${this.defaultAttrs.width}px`,height:`calc(100% - ${2*this.defaultAttrs["margin-y"]}px)`,"max-height":`${this.defaultAttrs.height}px`,position:"fixed",transition:"all .2s",margin:`${this.defaultAttrs["margin-y"]}px ${this.defaultAttrs["margin-x"]}px`,bottom:"-10px","border-radius":`${this.defaultAttrs["border-radius"]}px`,"z-index":"-1",visibility:"hidden",opacity:"0","-webkit-box-shadow":"0 3px 5px -1px rgba(0,0,0,.2), 0 5px 8px 0 rgba(0,0,0,.14), 0 1px 14px 0 rgba(0,0,0,.12)","box-shadow":"0 3px 5px -1px rgba(0,0,0,.2), 0 5px 8px 0 rgba(0,0,0,.14), 0 1px 14px 0 rgba(0,0,0,.12)",border:this.defaultAttrs.border,backgroud:"white"};const attrs=Object.keys(this.containerStyle);attrs.map(attrName=>{this.container.style[attrName]=this.containerStyle[attrName]})}toggleContainer(hard){if(!this.container)return!1;const isActive=this.togglerButtonElement.classList.contains("active");this.container.style["z-index"]=isActive?`${this.defaultAttrs["z-index"]}9`:"-1",this.container.style.visibility=isActive?"visible":"hidden",this.container.style.opacity=isActive?"1":"0",this.container.style.bottom=isActive?"0px":"-10px",this.container.dataset.state=isActive?"open":"minimized","50%"===this.container.style.left&&(this.container.style["-webkit-transform"]="translateX(-50%)",this.container.style.transform="translateX(-50%)"),hard||this.showToggler(!isActive),isActive&&this.showPopUp(!1)}setFrameLoaderAttributes(){this.iFrameLoaderAttrs={id:"ocular-widget-iframe-loader"};const attrs=Object.keys(this.iFrameLoaderAttrs);attrs.map(attrName=>{this.iFrameLoader.setAttribute(attrName,this.iFrameLoaderAttrs[attrName])})}setFrameLoaderStyle(){this.iFrameLoaderStyle={width:"100%","max-width":`${this.defaultAttrs.width}px`,height:"100%","max-height":`${this.defaultAttrs.height}px`,position:"fixed",transition:"all .2s","border-radius":"12px","z-index":"9",opacity:"1",border:this.defaultAttrs.border,background:"white",display:"flex","flex-wrap":"wrap","justify-content":"center","align-items":"center","align-content":"center"};const attrs=Object.keys(this.iFrameLoaderStyle);attrs.map(attrName=>{this.iFrameLoader.style[attrName]=this.iFrameLoaderStyle[attrName]})}createOcularFrameLoader(){if(!this.container)return!1;this.iFrameLoader=document.createElement("div"),this.setFrameLoaderAttributes(),this.setFrameLoaderStyle();const head=document.getElementsByTagName("head")[0],keyframes="\n      @keyframes play {\n        0% {\n            transform: scale(1);\n        }\n      \n        15% {\n            box-shadow: 0 0 0 5px rgba(21, 105, 255, 0.4);\n            transform: scale(1.1);\n        }\n      \n        25% {\n            box-shadow: 0 0 0 10px rgba(21, 105, 255, 0.4), 0 0 0 20px rgba(21, 105, 255, 0.2);\n            transform: scale(1.2);\n        }\n      \n        25% {\n            box-shadow: 0 0 0 15px rgba(21, 105, 255, 0.4), 0 0 0 30px rgba(21, 105, 255, 0.2);\n            transform: scale(1.3);\n        }\n\n        35% {\n            transform: scale(1.2);\n        }\n      }",style=document.createElement("STYLE");style.innerHTML=keyframes,head.appendChild(style);const element=document.createElement("div");element.style.background="#1569ff",element.style.width="100px",element.style.height="100px",element.style.position="relative",element.style["border-radius"]="100%",element.style.border="solid 0px #fff",element.style.animation="play 2s ease infinite",element.style["-webkit-backface-visibility"]="hidden",element.style["-moz-backface-visibility"]="hidden",element.style["-ms-backface-visibility"]="hidden",element.style["backface-visibility"]="hidden";const brand=document.createElement("img");brand.src=`${OCULAR_BASE_URL}/service/ocular/images/logoocular.jpg`,brand.style.width="100px",brand.style.height="100px",brand.style["object-fit"]="cover",brand.style["border-radius"]="50%",element.appendChild(brand);const container=document.createElement("div");container.style["text-align"]="center",container.appendChild(element),this.iFrameLoader.appendChild(container),this.container.appendChild(this.iFrameLoader)}createOcularFrame(){this.createOcularFrameLoader(),this.iFrame=document.createElement("iframe"),this.setFrameAttributes(),this.setFrameStyle(),this.setFrameSrc();const container=this.embedContainer?this.embedContainer:this.container;container.appendChild(this.iFrame)}setFrameSrc(){if(this.iFrame.src=`${OCULAR_APP_URL}?v=${(new Date).getTime().toString()}&${this.urlSearchParams()}&embed=${!!ocularWidget.embedContainer}`,!this.container)return!1;this.iFrame.addEventListener("load",()=>{this.iFrameLoader.style.visibility="hidden",this.iFrameLoader.style.opacity="0",this.iFrameLoader.style["z-index"]="-1"},!1)}setFrameAttributes(){this.iFrameAttrs={id:"ocular-widget-iframe",allowtransparency:"true",allow:"camera;microphone;display-capture;clipboard-read;clipboard-write"};const attrs=Object.keys(this.iFrameAttrs);attrs.map(attrName=>{this.iFrame.setAttribute(attrName,this.iFrameAttrs[attrName])})}setFrameStyle(){if(!this.iFrame)return!1;this.frameStyle={background:"white",width:"100%",height:`calc(100% - ${this.defaultAttrs["toolbar-height"]+1}px)`,border:"0px","border-bottom-right-radius":`${this.defaultAttrs["border-radius"]}px`,"border-bottom-left-radius":`${this.defaultAttrs["border-radius"]}px`,"border-top-right-radius":`${this.defaultAttrs["border-radius"]}px`,"border-top-left-radius":`${this.defaultAttrs["border-radius"]}px`};const attrs=Object.keys(this.frameStyle);attrs.map(attrName=>{this.iFrame.style[attrName]=this.frameStyle[attrName]})}createPopUp(){if(scriptOcularModules&&scriptOcularModules.includes("custom")&&!scriptOcular.dataset.popupMessage)return!1;if(this.embedContainer=document.getElementById("ocular-service-container"),this.embedContainer)return!1;this.popUp=document.createElement("div"),this.popUp.setAttribute("data-state","hide"),this.setPopUpAttributes(),this.setPopUpStyle();const closeButtonElement=document.createElement("button"),iconElement=document.createElement("img");iconElement.width="15",iconElement.height="15",iconElement.src=`${OCULAR_BASE_URL}/service/ocular/images/close-x.svg`,iconElement.alt="Ocular widget close x",closeButtonElement.appendChild(iconElement),closeButtonElement.style.width="30px",closeButtonElement.style.height="30px",closeButtonElement.style.position="absolute",closeButtonElement.style.top="0px",closeButtonElement.style.right="0px",closeButtonElement.style.border="0px",closeButtonElement.style.outline="none",closeButtonElement.style["border-radius"]="50px",closeButtonElement.style.padding="0px",closeButtonElement.style.cursor="pointer",closeButtonElement.style.background="transparent",closeButtonElement.style.margin="10px",closeButtonElement.addEventListener("click",()=>this.showPopUp(!1));const container=document.createElement("div");container.classList.add("ocular-popup-container"),this.popUp.appendChild(closeButtonElement),this.popUp.appendChild(container),this.popUpProgress(),this.siteBody.appendChild(this.popUp)}setPopUpContent(content){if(!this.popUp)return!1;const container=document.createElement("div");container.style.padding="20px",container.style["max-height"]="200px",container.style.overflow="auto",container.style.cursor="pointer",container.innerHTML=content,container.addEventListener("click",()=>this.show(!0)),this.popUp.querySelector("div.ocular-popup-container").innerHTML="",this.popUp.querySelector("div.ocular-popup-container").append(container)}setPopUpAttributes(){this.popUpAttrs={id:"ocular-widget-popup"};const attrs=Object.keys(this.popUpAttrs);attrs.map(attrName=>{this.popUp.setAttribute(attrName,this.popUpAttrs[attrName])})}setPopUpStyle(){if(!this.popUp)return!1;this.popUpStyle={width:"100%","max-width":`${this.defaultAttrs.width}px`,position:"fixed",transition:"all .2s",margin:`calc(${this.defaultAttrs["margin-y"]}px + 10px) ${this.defaultAttrs["margin-x"]}px`,bottom:"-10px","border-radius":`${this.defaultAttrs["border-radius"]}px`,"z-index":"-1",visibility:"hidden",opacity:"0","-webkit-box-shadow":"0px 0px 25px 6px #D3D3D3","box-shadow":"0px 0px 25px 6px #D3D3D3",border:"1px solid #E6E6E6",background:"white","font-size":"17px"};const attrs=Object.keys(this.popUpStyle);attrs.map(attrName=>{this.popUp.style[attrName]=this.popUpStyle[attrName]}),this.popUp.addEventListener("mouseenter",()=>{this.popUp.style.border="1px solid #888"}),this.popUp.addEventListener("mouseleave",()=>{this.popUp.style.border="1px solid #E6E6E6"})}showPopUp(show,popUpSound,popUpHandler=null){if(!this.popUp)return!1;if(this.container&&"open"!==this.container.dataset.state&&"hidden"!==this.container.dataset.state||(show=!1),popUpHandler){const container=this.popUp.querySelector("div.ocular-popup-container > div");container.addEventListener("click",()=>eval(popUpHandler))}this.popUp.style["z-index"]=show?`${this.defaultAttrs["z-index"]}99`:"-1",this.popUp.style.visibility=show?"visible":"hidden",this.popUp.style.opacity=show?"1":"0",this.popUp.style.bottom=show?"80px":"-10px",this.popUp.dataset.state=show?"show":"hide","50%"===this.popUp.style.left&&(this.popUp.style["-webkit-transform"]="translateX(-50%)",this.popUp.style.transform="translateX(-50%)"),this.interval&&clearInterval(this.interval),this.progressBarElement.style.width="auto",show&&(popUpSound&&this.playPopUpSound(),this.interval=setInterval(()=>{let width=this.progressBarElement.offsetWidth-2;width<=0&&(clearInterval(this.interval),this.showPopUp(!1)),this.progressBarElement.style.width=`${width}px`},50)),sessionStorage.setItem("ocular-popup-displayed","true")}popUpProgress(){this.progressBarElement=document.createElement("div"),this.setPopUpProgressStyle(),this.popUp.appendChild(this.progressBarElement)}setPopUpProgressStyle(){if(!this.progressBarElement)return!1;this.popUpProgressStyle={height:"3px",margin:"0px 20px",background:this.defaultAttrs["primary-color"],"border-radius":"20px",trasition:"width .2s"};const attrs=Object.keys(this.popUpProgressStyle);attrs.map(attrName=>{this.progressBarElement.style[attrName]=this.popUpProgressStyle[attrName]})}playPopUpSound(){const audio=new Audio(`${OCULAR_BASE_URL}/service/ocular/sounds/App_Notification.mp3`);audio.volume=.15,audio.play()}onOcularWidgetReady(){ocularWidget.embedContainer&&(this.iFrame||this.createOcularFrame())}ready(){try{this.onOcularWidgetReady(),onOcularWidgetReady()}catch(error){}}}const ocularWidget=new OcularWidget;class VersionChecker{constructor(){this.VERSION_CHECKER_STORAGE_NAME="ocular-app-version-checker",this.MAINTENANCE_STORAGE_NAME="ocular-in-maintenance",this.versionChecker}getMainVersionCheckerStorage(){const localStorageData=localStorage.getItem(this.VERSION_CHECKER_STORAGE_NAME),storageData=localStorageData?JSON.parse(localStorageData):null;return storageData}setMainVersionCheckerStorage(){localStorage.setItem(this.VERSION_CHECKER_STORAGE_NAME,JSON.stringify(this.versionChecker))}setVersion(changeDate){if(!changeDate){const date=(new Date).toISOString().split("T")[0];changeDate=`${date} 00:00:00`}this.versionChecker={changeDate:changeDate,lastTime:(new Date).getTime()},this.setMainVersionCheckerStorage()}clearStorage(){localStorage.removeItem("ocular-app-basic"),localStorage.removeItem("ocular-app-widget"),localStorage.removeItem("ocular-app-questionnary"),localStorage.removeItem("ocular-app-widget-urls")}versionCompare(version=null){const storage=JSON.parse(localStorage.getItem("ocular-app")),state=storage?storage.state:0;if(4===state.id)return!1;this.versionChecker&&version&&new Date(version.change_date).getTime()===new Date(this.versionChecker.changeDate).getTime()||(this.setVersion(version?version.change_date:null),this.clearStorage())}getTimeInterval(){if(!this.versionChecker)return!0;const lastTime=this.versionChecker.lastTime?this.versionChecker.lastTime:0,currentTime=(new Date).getTime(),available=currentTime-lastTime>6e4;return available&&(this.versionChecker.lastTime=currentTime,this.setMainVersionCheckerStorage()),available}setMaintenance(maintenance){maintenance?localStorage.setItem(this.MAINTENANCE_STORAGE_NAME,"maintenance"):localStorage.getItem(this.MAINTENANCE_STORAGE_NAME)&&localStorage.removeItem(this.MAINTENANCE_STORAGE_NAME)}inMaintenance(){return!!localStorage.getItem(this.MAINTENANCE_STORAGE_NAME)}async getMainVersionChecker(){const data={route:"ocular/widget/widget-version",method:"GET",params:{}};return this.versionChecker=this.getMainVersionCheckerStorage(),this.versionChecker?!!this.getTimeInterval()&&(mountOcular.widgetCode&&(data.params.code=mountOcular.widgetCode),ocularWidget.ajaxRequest(data).then(response=>{const res=response;if(res&&0===res.statusCode){const maintenance=!!res.maintenance&&res.maintenance;this.setMaintenance(maintenance),this.versionCompare(res.widgetVersion)}}).catch(error=>{console.log(error)})):(this.versionCompare(),!1)}}const versionChecker=new VersionChecker;class WidgetIndentificator{constructor(){this.STORAGE_NAME="ocular-solution-widget-id",this.uuid=null}getStorage(){const localStorageData=localStorage.getItem(this.STORAGE_NAME),storage=localStorageData||null;try{ocularWidget.crossDomainMessage(`uuidGenerator.setUuid(${JSON.stringify(storage)})`)}catch(error){console.log("crossDomainMessage disable")}}setStorage(data){localStorage.setItem(this.STORAGE_NAME,data)}}const widgetIndentificator=new WidgetIndentificator;class AnalitycsStorage{constructor(){this.OCULAR_DEVICE_ANALITYCS_STORAGE_NAME="ocular-device-analitycs",this.device=ocularWidget.getDevice(),this.storageData={analitycId:null,device:null,customer:null,country:null,sessionId:null,history:[]},this.widgetUuid=null}uuidGenerator(){let d=(new Date).getTime(),d2="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return this.widgetUuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,c=>{let r=16*Math.random();return d>0?(r=(d+r)%16|0,d=Math.floor(d/16)):(r=(d2+r)%16|0,d2=Math.floor(d2/16)),("x"===c?r:3&r|8).toString(16)}),this.widgetUuid}initializeDeviceData(){const device={widgetUuid:this.widgetUuid?this.widgetUuid:this.uuidGenerator(),browser:this.device.browserName,mobile:this.device.mobile,so:this.device.so,fromWeb:document.referrer,baseUrl:window.location.href,userAgent:this.device.userAgent,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone};this.storageData.device=device}saveStorageData(){sessionStorage.setItem(this.OCULAR_DEVICE_ANALITYCS_STORAGE_NAME,JSON.stringify(this.storageData))}updateStorageData(data){this.storageData=data,this.saveStorageData()}initializeStorageData(hard=!1,country=null){let appData=localStorage.getItem("ocular-app");appData=appData?JSON.parse(appData):null,this.storageData={analitycId:!hard&&this.storageData&&this.storageData.analitycId?this.storageData.analitycId:null,device:this.storageData&&this.storageData.device?this.storageData.device:null,customer:appData&&appData.room&&appData.room.customer?appData.room.customer:null,country:country,sessionId:appData&&appData.room&&appData.room.session&&appData.room.session.id?appData.room.session.id:null,history:!hard&&this.storageData&&this.storageData.history?this.storageData.history:[]},this.storageData.device||this.initializeDeviceData()}resetStorageData(){this.initializeStorageData(!0),this.saveStorageData()}removeStorageData(){sessionStorage.removeItem(this.OCULAR_DEVICE_ANALITYCS_STORAGE_NAME)}initializeStorage(country){const data=sessionStorage.getItem(this.OCULAR_DEVICE_ANALITYCS_STORAGE_NAME);this.storageData=data?JSON.parse(data):null,this.initializeStorageData(!1,country)}addHistoryItem(historyItem,country){this.initializeStorage(country),this.storageData.history.unshift(historyItem),this.saveStorageData(),ocularWidget.crossDomainMessage(`ocularAnalitycs.addHistoryItem(${JSON.stringify(historyItem)}, ${JSON.stringify(this.storageData)})`)}}const analitycsStorage=new AnalitycsStorage;class GoogleAnalitycs{constructor(){window.dataLayer=window.dataLayer||[]}dataLayerPush(data){console.table(data),dataLayer.push(data)}}const ocGoogleAnalitycs=new GoogleAnalitycs;class OcularStorage{constructor(){this.STORAGE_NAME="ocular-app"}updateStorageData(data){localStorage.setItem(this.STORAGE_NAME,JSON.stringify(data))}}const ocularStorage=new OcularStorage;class OcularLocalStorage{constructor(){this.STORAGE_NAME="ocular-app",this.states=[{id:1,name:"progress",actionState:!1},{id:2,name:"calling",actionState:!0},{id:3,name:"queue",actionState:!0},{id:4,name:"call",actionState:!0},{id:5,name:"rating",actionState:!0},{id:6,name:"Finished",actionState:!1},{id:7,name:"Optimizando",actionState:!0},{id:8,name:"Streaming",actionState:!0}]}setStorage(){const localStorageData=localStorage.getItem(this.STORAGE_NAME);this.storage=localStorageData?JSON.parse(localStorageData):null}updateStorageData(){localStorage.setItem(this.STORAGE_NAME,JSON.stringify(this.storage))}setWidgetCode(code){this.storage.widget.code=code,this.updateStorageData()}initialize(hard=!1){this.setStorage(),this.storage={activeRoute:!hard&&this.storage&&this.storage.activeRoute?this.storage.activeRoute:"/",state:!hard&&this.storage&&this.storage.state?this.storage.state:this.states[0],category:!hard&&this.storage&&this.storage.category?this.storage.category:null,codec:!hard&&this.storage&&this.storage.codec?this.storage.codec:"VP8",form:{code:!hard&&this.storage&&this.storage.form&&this.storage.form.code?this.storage.form.code:null},widget:{code:!hard&&this.storage&&this.storage.widget?this.storage.widget.code:null,lang:!hard&&this.storage&&this.storage.widget?this.storage.widget.lang:null},device:{camera:!(!hard&&this.storage&&this.storage.device)||this.storage.device.camera,microphone:!(!hard&&this.storage&&this.storage.device)||this.storage.device.microphone,screen:!(hard||!this.storage||!this.storage.device)&&this.storage.device.screen},room:{currentLocation:this.storage&&this.storage.room&&this.storage.room.currentLocation?this.storage.room.currentLocation:{url:null,title:null},connected:!!(this.storage&&this.storage.room&&this.storage.room&&void 0!==this.storage.room.connected)&&this.storage.room.connected,customer:this.storage&&this.storage.room&&this.storage.room.customer?this.storage.room.customer:null,cammer:!hard&&this.storage&&this.storage.room&&this.storage.room.cammer?this.storage.room.cammer:{user:{}},publisher:!hard&&this.storage&&this.storage.room&&this.storage.room.publisher?this.storage.room.publisher:null,publisherSettings:!hard&&this.storage&&this.storage.room&&this.storage.room.publisherSettings?this.storage.room.publisherSettings:null,chat:!hard&&this.storage&&this.storage.room&&this.storage.room.chat?this.storage.room.chat:[],recommendations:!hard&&this.storage&&this.storage.room&&this.storage.room.recommendations?this.storage.room.recommendations:[],session:{id:!hard&&this.storage&&this.storage.room&&this.storage.room.session.id?this.storage.room.session.id:null,tokboxId:!hard&&this.storage&&this.storage.room&&this.storage.room.session.tokboxId?this.storage.room.session.tokboxId:null,token:!hard&&this.storage&&this.storage.room&&this.storage.room.session.token?this.storage.room.session.token:null},streams:[]}},this.updateStorageData()}}const ocularLocalStorage=new OcularLocalStorage;class Organization{constructor(){this.widgetBasic,this.widget,this.WIDGET_BASIC_STORAGE_NAME="ocular-app-basic",this.WIDGET_STORAGE_NAME="ocular-app-widget"}getWidgetBasicStorage(){const localStorageData=localStorage.getItem(this.WIDGET_BASIC_STORAGE_NAME),storageData=localStorageData?JSON.parse(localStorageData):null;return this.widgetBasic=storageData,storageData}setWidgetBasicStorage(){localStorage.setItem(this.WIDGET_BASIC_STORAGE_NAME,JSON.stringify(this.widgetBasic))}getWidgetStorage(){const localStorageData=localStorage.getItem(this.WIDGET_STORAGE_NAME),storageData=localStorageData?JSON.parse(localStorageData):null;return storageData}setWidgetStorage(){localStorage.setItem(this.WIDGET_STORAGE_NAME,JSON.stringify(this.widget))}async mount(){if(this.widgetBasic=this.widgetBasic?this.widgetBasic:this.getWidgetBasicStorage(),this.widgetBasic)widget.mount(this.widgetBasic);else{let currentLocation=`${location.origin}${location.pathname}`;currentLocation=currentLocation.endsWith("/")?currentLocation:`${currentLocation}/`;const data={route:"ocular/widget/mount-ocular",method:"GET",params:{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,url:currentLocation},successHandler:"organization.mountOrganizationSuccess",errorHandler:"organization.mountOrganizationError"},receivedParameters=new URLSearchParams(location.search),fromLink=receivedParameters.get("ocularSessionId")||receivedParameters.get("ocularLinkSessionId")||receivedParameters.get("ocularStreaming")?1:0;fromLink&&(data.params.fromLink=fromLink),mountOcular.widgetCode&&(data.params.code=mountOcular.widgetCode),await ocularWidget.ajaxRequest(data).then(response=>{const res=response;res&&0===res.statusCode&&res.widget&&(this.widgetBasic=res.widget,this.setWidgetBasicStorage(),versionChecker.setVersion(res.widget.version_date),widget.mount(this.widgetBasic))}).catch(error=>{console.log(error)})}}async getWidget(data){this.widget=this.getWidgetStorage(),this.widget?ocularWidget.crossDomainMessage(`${data.successHandler}(${JSON.stringify(this.widget)}, ${JSON.stringify(ocularLocalStorage.storage)})`):(mountOcular.widgetCode&&(data.params.code=mountOcular.widgetCode),await ocularWidget.ajaxRequest(data).then(response=>{const res=response;res&&0===res.statusCode&&res.widget&&res.widget.uuid?(this.widget=res.widget,this.setWidgetStorage(),ocularWidget.crossDomainMessage(`${data.successHandler}(${JSON.stringify(this.widget)}, ${JSON.stringify(ocularLocalStorage.storage)})`)):ocularWidget.crossDomainMessage(`${data.errorHandler}(${JSON.stringify(res)})`)}).catch(error=>{console.log(error),ocularWidget.crossDomainMessage(`${data.errorHandler}(${JSON.stringify(error)})`)}))}}const organization=new Organization;class OrganizationUrl{constructor(){this.widgetUrls,this.widget_URLS_STORAGE_NAME="ocular-app-widget-urls"}getOrganizationUrlsStorage(){const localStorageData=localStorage.getItem(this.widget_URLS_STORAGE_NAME),storageData=localStorageData?JSON.parse(localStorageData):null;return storageData}setOrganizationUrlsStorage(){localStorage.setItem(this.widget_URLS_STORAGE_NAME,JSON.stringify(this.widgetUrls))}async getOrganizationUrls(data){this.widgetUrls=this.getOrganizationUrlsStorage(),this.widgetUrls?ocularWidget.crossDomainMessage(`${data.successHandler}(${JSON.stringify(this.widgetUrls)})`):await ocularWidget.ajaxRequest(data).then(response=>{const res=response;res&&0===res.statusCode&&res.urls&&res.urls.length?(this.widgetUrls=res.urls,this.setOrganizationUrlsStorage(),ocularWidget.crossDomainMessage(`${data.successHandler}(${JSON.stringify(this.widgetUrls)})`)):ocularWidget.crossDomainMessage(`${data.errorHandler}(${JSON.stringify(res)})`)}).catch(error=>{console.log(error),ocularWidget.crossDomainMessage(`${data.errorHandler}(${JSON.stringify(error)})`)})}}const organizationUrls=new OrganizationUrl;class Questionnary{constructor(){this.QUESTIONNARY_STORAGE_NAME="ocular-app-questionnary",this.questionnary}getMainQuestionnaryStorage(){const localStorageData=localStorage.getItem(this.QUESTIONNARY_STORAGE_NAME),storageData=localStorageData?JSON.parse(localStorageData):null;return storageData}setMainQuestionnaryStorage(){localStorage.setItem(this.QUESTIONNARY_STORAGE_NAME,JSON.stringify(this.questionnary))}async getMainQuestionnary(data){this.questionnary=this.getMainQuestionnaryStorage(),this.questionnary?ocularWidget.crossDomainMessage(`${data.successHandler}(${JSON.stringify(this.questionnary)})`):(mountOcular.widgetCode&&(data.params.code=mountOcular.widgetCode),await ocularWidget.ajaxRequest(data).then(response=>{const res=response;res&&0===res.statusCode&&res.questionnary?(this.questionnary={item:res.questionnary,geoip:res.geoip?res.geoip:store.state.questionnary.geoip},this.setMainQuestionnaryStorage(),ocularWidget.crossDomainMessage(`${data.successHandler}(${JSON.stringify(this.questionnary)})`)):ocularWidget.crossDomainMessage(`${data.errorHandler}(${JSON.stringify(res)})`)}).catch(error=>{console.log(error),ocularWidget.crossDomainMessage(`${data.errorHandler}(${JSON.stringify(error)})`)}))}}const questionnary=new Questionnary;class MainService{async apiRequest(data){mountOcular.widgetCode&&(data.params.code=mountOcular.widgetCode),await ocularWidget.ajaxRequest(data).then(response=>{const res=response;ocularWidget.crossDomainMessage(`${data.successHandler}(${JSON.stringify(res)})`)}).catch(error=>{ocularWidget.crossDomainMessage(`${data.catchHandler}(${JSON.stringify(error)})`)})}}const mainService=new MainService,ocularElement={toggleButtons:[],parentToggleButtons:[],serviceContainer:null},setOcularElements=()=>{ocularElement.toggleButtons=document.querySelectorAll(".ocular-toggler"),ocularElement.parentToggleButtons=document.querySelectorAll(".ocular-parent-toggler"),ocularElement.serviceContainer=document.querySelector("#ocular-service-container")},widgetToggle=()=>{if(!ocularElement.toggleButtons)return!1;ocularElement.toggleButtons.forEach(element=>{element.onclick=()=>{ocularWidget.toggle()}})},widgetParentToggle=()=>{if(!ocularElement.parentToggleButtons)return!1;ocularElement.parentToggleButtons.forEach(element=>{element.onclick=()=>{OCULAR_SESSION_ID?ocularWidget.toggle():ocularWidget.parentToggle()}})},clearOcular=()=>{const toggler=document.querySelector("#ocular-widget-toggler"),popUp=document.querySelector("#ocular-widget-popup"),container=document.querySelector("#ocular-widget-container");toggler&&toggler.remove(),popUp&&popUp.remove(),container&&container.remove()},findServiceContainer=async()=>!!ocularElement.serviceContainer&&(!ocularElement.serviceContainer.querySelector("iframe#ocular-widget-iframe")&&(clearOcular(),void await ocularWidget.init()));class Widget{togglerConfig(attributes){let width=attributes.find(attr=>18===attr.type);width=width?width.value:null;let height=attributes.find(attr=>19===attr.type);height=height?height.value:null;let borderRadius=attributes.find(attr=>20===attr.type);borderRadius=borderRadius?borderRadius.value:null;let boxShadow=attributes.find(attr=>38===attr.type);boxShadow=!boxShadow||"true"===boxShadow.value;let color=attributes.find(attr=>39===attr.type);color=color?color.value:null;const imageWidth=attributes.find(attr=>21===attr.type),imageHeight=attributes.find(attr=>37===attr.type),imageUrl=attributes.find(attr=>22===attr.type),image={width:imageWidth?imageWidth.value:null,height:imageHeight?imageHeight.value:null,src:imageUrl?imageUrl.value:null};return{color:color,width:width,height:height,borderRadius:borderRadius,image:image,boxShadow:boxShadow}}createScripts(data){for(let index=0;index<data.length;index++){const ocularTrackerScriptElement=document.createElement("script"),script=data[index];for(const keyScript in script)if(Object.hasOwnProperty.call(script,keyScript)){const scriptValue=script[keyScript];ocularTrackerScriptElement.setAttribute(keyScript,scriptValue)}ocularParentBody.appendChild(ocularTrackerScriptElement)}}setMountConfig(attributes){const primaryColor=attributes.find(attr=>14===attr.type),borderRadius=attributes.find(attr=>15===attr.type),zIndex=attributes.find(attr=>17===attr.type);let marginX=attributes.find(attr=>23===attr.type);marginX=marginX?marginX.value:null;let marginY=attributes.find(attr=>24===attr.type);marginY=marginY?marginY.value:null;const margins={marginX:marginX,marginY:marginY},toggler=this.togglerConfig(attributes),config={primaryColor:primaryColor?primaryColor.value:null,borderRadius:borderRadius?borderRadius.value:null,zIndex:zIndex?zIndex.value:null,height:630,marginX:margins.marginX,marginY:margins.marginY,toggler:toggler},positionAttr=attributes.find(attr=>7===attr.type),position=positionAttr?positionAttr.value:"right";ocularWidget.align(position),ocularWidget.setDefaultConfig(config);const scriptsCreatorAttr=attributes.find(attr=>55===attr.type&&"true"===attr.value);scriptsCreatorAttr&&JSON.parse(scriptsCreatorAttr.data).length>0&&this.createScripts(JSON.parse(scriptsCreatorAttr.data))}popupDisplayed(){return!!sessionStorage.getItem("ocular-popup-displayed")}showPopUpContent(innerHtml="",popUpSound=!0){return ocularWidget.setPopUpContent(innerHtml),ocularWidget.showPopUp(!0,popUpSound),"popup content set success"}showPopUpMessage(attributes){const widgetMessageAttr=attributes.find(attr=>3===attr.type),widgetMessageSoundAttr=attributes.find(attr=>12===attr.type&&"false"===attr.value),popUpSound=!widgetMessageSoundAttr,showPopup=attributes.find(attr=>13===attr.type&&"true"===attr.value);if(!showPopup)return!1;const content=widgetMessageAttr?widgetMessageAttr.value:'<h3 class="card-text" style="margin: 0px; font-weight: 400">                                                                    😎 <br> <b>Tienes dudas?</b> conversa con un agente en vivo.                                                                   </h3>';this.showPopUpContent(content,popUpSound)}initialVisibility(attributes){const widgetAttr=attributes.find(attr=>10===attr.type&&"false"===attr.value),visible=!widgetAttr;return visible}urlVisivility(urls,state){let visible=!0;if(!state.actionState&&urls.length){let currentLocation=`${location.hostname}${location.pathname}`;currentLocation=currentLocation.endsWith("/")?currentLocation:`${currentLocation}/`,visible=!!urls.find(url=>currentLocation.indexOf(url)>-1)}return visible}deviceVisibility(attributes){let visible=!0;const onDesktop=!attributes.find(attr=>8===attr.type&&"false"===attr.value),onMobile=!attributes.find(attr=>9===attr.type&&"false"===attr.value);return onDesktop||ocularWidget.device.mobile?!onMobile&&ocularWidget.device.mobile&&(visible=!1):visible=!1,visible}mountCustom(){const dataset=scriptOcular.dataset;organization.widgetBasic={attributes:[{type:3,value:dataset.popupMessage?dataset.popupMessage:null},{type:9,value:"true"},{type:8,value:"true"},{type:10,value:dataset.show?dataset.show:"true"},{type:12,value:dataset.popupSound?dataset.popupSound:"true"},{type:13,value:"true"},{type:14,value:dataset.color},{type:15,value:"10"},{type:17,value:"999999999999999999"},{type:22,value:dataset.image},{type:38,value:"true"},{type:39,value:dataset.color}],show_service:!0,attending:!0}}mount(data){const widget=data,attributes=widget.attributes,urls=widget.urls?widget.urls:[];if(!widget||!widget.show_service)return!1;attributes.length&&this.setMountConfig(attributes),ocularWidget.ready();const storage=JSON.parse(localStorage.getItem("ocular-app")),state=storage?storage.state:null;let open=state.actionState;const receivedParameters=new URLSearchParams(location.search);if(receivedParameters.get("ocularSessionId")||receivedParameters.get("ocularLinkSessionId")||receivedParameters.get("ocularStreaming"))open=!0;else{if(!this.urlVisivility(urls,state)&&!state.actionState)return!1;if(!(this.deviceVisibility(attributes)&&this.initialVisibility(attributes)||state.actionState))return!1}const createApp=attributes.find(attr=>44===attr.type&&"true"===attr.value);setTimeout(()=>{ocularWidget.show(open,!0,createApp)},100)}}const widget=new Widget;class MountOcular{constructor(){this.widgetCode=scriptOcular?scriptOcular.getAttribute("code"):null}async start(){if(this.cookieEnabled=navigator.cookieEnabled,!this.cookieEnabled)return console.log("ACTIVAR LAS COOKIES DEL NAVEGADOR PARA MONTAR EL SERVICIO DE OCULAR"),!1;await ocularWidget.init(),ocularLocalStorage.initialize();const storeCode=ocularLocalStorage.storage.widget.code,state=ocularLocalStorage.storage.state;return this.widgetCode&&!storeCode?(ocularLocalStorage.setWidgetCode(this.widgetCode),await versionChecker.getMainVersionChecker()):this.widgetCode&&storeCode!==this.widgetCode&&!state.actionState?(ocularLocalStorage.setWidgetCode(this.widgetCode),versionChecker.clearStorage()):await versionChecker.getMainVersionChecker(),versionChecker.inMaintenance()?(console.log("OCULAR EN MANTENIMIENTO"),!1):(scriptOcularModules&&scriptOcularModules.includes("custom")&&widget.mountCustom(),organization.mount(),"Success")}}const mountOcular=new MountOcular;mountOcular.start();const createObserver=()=>{if(!document)return!1;const observer=new MutationObserver(()=>{runFunctions()});observer.observe(document,{attributes:!0,childList:!0,subtree:!0})},runFunctions=async()=>{setOcularElements(),await findServiceContainer(),widgetToggle(),widgetParentToggle()};createObserver();